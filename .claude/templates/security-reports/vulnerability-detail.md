# Vulnerability Detail Report

## Basic Information

| Field | Value |
|-------|-------|
| **Vulnerability ID** | {{VULN_ID}} |
| **Title** | {{VULN_TITLE}} |
| **Severity** | {{SEVERITY}} |
| **CVSS Score** | {{CVSS_SCORE}} |
| **CVSS Vector** | {{CVSS_VECTOR}} |
| **CWE** | {{CWE_ID}} - {{CWE_NAME}} |
| **OWASP** | {{OWASP_CATEGORY}} |
| **Discovery Date** | {{DISCOVERY_DATE}} |
| **Verification Status** | {{VERIFICATION_STATUS}} |
| **Priority** | {{PRIORITY}} |

---

## Vulnerability Description

{{DESCRIPTION}}

---

## Impact Assessment

### Affected Components

| Component | Location | Type |
|-----------|----------|------|
{{#AFFECTED_COMPONENTS}}
| {{COMPONENT_NAME}} | {{COMPONENT_LOCATION}} | {{COMPONENT_TYPE}} |
{{/AFFECTED_COMPONENTS}}

### CIA Impact

| Aspect | Impact Level | Description |
|--------|--------------|-------------|
| **Confidentiality** | {{IMPACT_CONFIDENTIALITY}} | {{IMPACT_CONFIDENTIALITY_DESC}} |
| **Integrity** | {{IMPACT_INTEGRITY}} | {{IMPACT_INTEGRITY_DESC}} |
| **Availability** | {{IMPACT_AVAILABILITY}} | {{IMPACT_AVAILABILITY_DESC}} |

### Affected Data/Users

- **User Scope**: {{USER_SCOPE}}
- **Data Scope**: {{DATA_SCOPE}}
- **Estimated Records**: {{ESTIMATED_RECORDS}}

---

## Evidence Chain

### 1. Code Location

**Vulnerable Code** (`{{CODE_FILE}}:{{CODE_LINE_START}}-{{CODE_LINE_END}}`)

```{{CODE_LANGUAGE}}
{{VULNERABLE_CODE}}
```

**Context** (±10 lines)

```{{CODE_LANGUAGE}}
{{CONTEXT_CODE}}
```

### 2. Data Flow Analysis

**Source → Sink Path**

```
┌─────────────────────────────────────────────────────────┐
│  SOURCE: {{SOURCE}}                                     │
│     ↓                                                   │
│  TRANSFORM: {{TRANSFORM}}                               │
│     ↓                                                   │
│  SINK: {{SINK}}                                         │
└─────────────────────────────────────────────────────────┘
```

**Data Flow Diagram**

```
{{DATAFLOW_DIAGRAM}}
```

### 3. Static Analysis Evidence

**ast-grep Match**

```yaml
{{AST_GREP_RESULT}}
```

**grep Evidence**

```bash
{{GREP_EVIDENCE}}
```

### 4. PoC Verification

**HTTP Request**

```http
{{POC_REQUEST}}
```

**cURL Command**

```bash
{{POC_CURL}}
```

**Python PoC Script**

```python
{{POC_PYTHON}}
```

**Response**

```http
{{POC_RESPONSE}}
```

### 5. Execution Logs

**Application Logs**

```
{{APP_LOGS}}
```

**Database Logs**

```sql
{{DB_LOGS}}
```

### 6. Payload Variants

| Payload | Purpose | Result |
|---------|---------|--------|
{{#PAYLOADS}}
| `{{PAYLOAD}}` | {{PURPOSE}} | {{RESULT}} |
{{/PAYLOADS}}

### 7. Model Analysis

**Why This Is Exploitable**

```
{{MODEL_ANALYSIS}}
```

**Exploitation Conditions**

{{#EXPLOIT_CONDITIONS}}
- {{CONDITION}}
{{/EXPLOIT_CONDITIONS}}

**Exploitation Difficulty**: {{EXPLOIT_DIFFICULTY}}
**Reliability**: {{EXPLOIT_RELIABILITY}}

---

## Reproducible Artifacts

### Environment Requirements

```yaml
{{ENVIRONMENT_YAML}}
```

### Reproduction Steps

{{#REPRO_STEPS}}
{{STEP_NUMBER}}. {{STEP_DESCRIPTION}}
```bash
{{STEP_COMMAND}}
```
{{/REPRO_STEPS}}

### PoC Files

| File | Description |
|------|-------------|
{{#POC_FILES}}
| `{{FILE_NAME}}` | {{FILE_DESCRIPTION}} |
{{/POC_FILES}}

---

## Fix Recommendation

### Recommended Fix

**Fixed Code**

```{{CODE_LANGUAGE}}
{{FIXED_CODE}}
```

### Framework Best Practices

{{#FRAMEWORK_PRACTICES}}
**{{FRAMEWORK_NAME}}**

```{{FRAMEWORK_LANGUAGE}}
{{FRAMEWORK_CODE}}
```

{{/FRAMEWORK_PRACTICES}}

### Additional Security Measures

{{#SECURITY_MEASURES}}
{{MEASURE_NUMBER}}. **{{MEASURE_TITLE}}**: {{MEASURE_DESCRIPTION}}
{{/SECURITY_MEASURES}}

### Configuration Recommendations

```{{CONFIG_LANGUAGE}}
{{CONFIG_CODE}}
```

---

## References

{{#REFERENCES}}
- [{{REF_TITLE}}]({{REF_URL}})
{{/REFERENCES}}

---

## Report Metadata

| Field | Value |
|-------|-------|
| Report Generated | {{GENERATED_AT}} |
| Report Version | {{REPORT_VERSION}} |
| Verified By | {{VERIFIED_BY}} |
| Review Status | {{REVIEW_STATUS}} |

---

*This report was generated by Security Reporter Agent*
