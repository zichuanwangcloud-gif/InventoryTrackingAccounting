
# 安全审计命令

> 执行全面的安全评估和漏洞分析

## 使用方式

在 Cursor 中通过命令面板（Cmd+Shift+P）或直接引用此命令，AI 将帮助你执行全面的安全审计。

## 使用示例

### 示例 1：基本安全审计

```bash
# 在 Cursor 中执行
/security-audit

# AI 将自动：
# 1. 扫描所有代码文件
# 2. 检查依赖安全漏洞
# 3. 识别硬编码密钥
# 4. 分析输入验证问题
# 5. 生成安全审计报告
```

### 示例 2：仅检查依赖安全

```bash
# 在 Cursor 中执行
/security-audit --focus dependencies

# AI 将：
# 1. 运行 npm audit / pip-audit / cargo audit
# 2. 检查已知 CVE 漏洞
# 3. 提供修复建议
```

### 示例 3：扫描密钥和敏感信息

```bash
# 在 Cursor 中执行
/security-audit --focus secrets

# AI 将：
# 1. 扫描代码中的硬编码密钥
# 2. 检查配置文件中的敏感信息
# 3. 识别暴露的 API 密钥和密码
# 4. 提供修复建议
```

## 功能描述

对代码库进行系统化的安全审计，识别潜在漏洞并提供修复建议。

## 审计范围

### 1. 环境设置

- 识别技术栈和框架
- 检查现有安全工具和配置
- 审查部署和基础设施设置

### 2. 依赖安全

- 扫描所有依赖的已知漏洞
- 检查存在安全问题的过时包
- 审查依赖来源和完整性
- 使用适当的工具：`npm audit`、`pip check`、`cargo audit` 等

### 3. 身份认证与授权

- 审查身份认证机制和实现
- 检查会话管理是否正确
- 验证授权控制和访问限制
- 检查密码策略和存储

### 4. 输入验证与清理

- 检查所有用户输入的验证和清理
- 查找 SQL 注入漏洞
- 识别潜在的 XSS（跨站脚本）问题
- 审查文件上传安全性和验证

### 5. 数据保护

- 识别敏感数据处理实践
- 检查静态和传输中数据的加密实现
- 审查数据脱敏和匿名化实践
- 验证安全通信协议（HTTPS、TLS）

### 6. 密钥管理

- 扫描硬编码的密钥、API 密钥和密码
- 检查密钥管理实践是否正确
- 审查环境变量安全性
- 识别暴露的配置文件

### 7. 错误处理与日志

- 审查错误消息是否存在信息泄露
- 检查安全事件的日志实践
- 验证敏感数据未被记录
- 评估错误处理的健壮性

### 8. 基础设施安全

- 审查容器化安全（Docker 等）
- 检查 CI/CD 管道安全
- 检查云配置和权限
- 评估网络安全配置

### 9. 安全头和 CORS

- 检查安全头实现
- 审查 CORS 配置
- 验证 CSP（内容安全策略）设置
- 检查 Cookie 安全属性

### 10. 报告生成

- 记录所有发现及严重级别（严重、高、中、低）
- 为每个问题提供具体的修复步骤
- 包含代码示例和文件引用
- 创建包含关键建议的执行摘要

## 严重级别定义

| 级别 | 描述 | 响应时间 |
|------|------|----------|
| 严重 | 可立即被利用，影响系统完整性 | 立即修复 |
| 高 | 严重漏洞，需要紧急处理 | 24小时内 |
| 中 | 重要问题，需要计划修复 | 1周内 |
| 低 | 轻微问题，可在后续迭代中修复 | 下次发布前 |

## 输出格式

```markdown
# 安全审计报告

**审计日期**：YYYY-MM-DD
**审计范围**：[描述]
**审计人**：Security Auditor

## 执行摘要

[简要概述安全状况和主要发现]

## 严重问题（必须立即修复）

| 编号 | 问题 | 位置 | 描述 | 修复建议 |
|------|------|------|------|----------|
| C-01 | ... | ... | ... | ... |

## 高风险问题（需要紧急处理）

| 编号 | 问题 | 位置 | 描述 | 修复建议 |
|------|------|------|------|----------|
| H-01 | ... | ... | ... | ... |

## 中风险问题（计划修复）

| 编号 | 问题 | 位置 | 描述 | 修复建议 |
|------|------|------|------|----------|
| M-01 | ... | ... | ... | ... |

## 低风险问题（后续改进）

| 编号 | 问题 | 位置 | 描述 | 修复建议 |
|------|------|------|------|----------|
| L-01 | ... | ... | ... | ... |

## 下一步行动

1. [行动项 1]
2. [行动项 2]
```

## 常用检查命令

```bash
# Node.js 依赖检查
npm audit --audit-level=moderate

# Python 依赖检查
pip check
pip-audit

# 密钥扫描
git log -p | grep -i "password\|secret\|api_key\|token"

# 查找敏感文件
find . -name "*.env" -o -name "*credentials*" -o -name "*secret*"
```

## 注意事项

- 使用自动化安全扫描工具时，需要手动审查复杂的安全模式
- 发现严重漏洞时应立即通知相关人员
- 所有发现应保密处理，不应公开披露
- 修复后应进行回归测试确保不引入新问题

## 相关命令

- `code-review`: 代码审查
- `test-governance`: 测试治理

------

**最后更新**：2025-11-29
**维护者**：Security Team
**版本**：1.0.0
